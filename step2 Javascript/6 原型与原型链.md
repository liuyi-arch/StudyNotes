### 一、构造函数与实例

```js
function Person() {}
const p1 = new Person();
```

- `Person` 是构造函数
- `p1` 是通过 `new` 创建的实例

------

### 二、prototype 与 `__proto__`

```js
function Person() {}
Person.prototype.name = 'Kevin';

const p1 = new Person();
console.log(p1.name); // Kevin
console.log(p1.__proto__.name); // Kevin
```

- 函数 `Person` 有一个 `.prototype` 属性
- 实例对象的 `__proto__` 指向构造函数的 `.prototype`

```js
p1.__proto__ === Person.prototype; // true
```

------

### 三、constructor 属性

- 每个 `.prototype` 对象默认有一个 `.constructor` 属性，指回原构造函数：

```js
Person.prototype.constructor === Person; // true
```

- 注意：如果**重写原型对象，要手动补回来**：

```js
function Person() { }

Person.prototype = {
    sayHi1: function () { }
};
console.log(Person.prototype.constructor === Person); // false

Person.prototype = {
    constructor: Person,
    sayHi2: function () { }
};
console.log(Person.prototype.constructor === Person); // true
```

------

### 四、实例查找属性：原型链机制

首先，直接说明结论：从实例person到原型链的顶端原型链路见如下蓝线。

![img](https://camo.githubusercontent.com/08a50fb0cf1cfdbae849f0827ecc5761899805c2ca7b0232264b622d4f1c04bb/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f6d717971696e6766656e672f426c6f672f496d616765732f70726f746f74797065352e706e67)

函数与实例对象有如下关系：

```js
console.log(p1.__proto__ === Person.prototype); // true
console.log(Person.prototype.__proto__ === Object.prototype); // true
console.log(Object.prototype.__proto__ === null); // true
```

通过下列示例代码，清晰易懂的了解原型链机制：

```js
Object.prototype.name = 'name1'

function Person() {}
Person.prototype.name = 'name2';

const p1 = new Person();
p1.name = 'name3';

console.log(p1.__proto__ === Person.prototype); // true
console.log(Person.prototype.__proto__ === Object.prototype); // true
console.log(Object.prototype.__proto__ === null); // true

console.log(p1.name); // name3
console.log(p1.__proto__.name); // name2
console.log(p1.__proto__.__proto__.name); // name1

delete p1.name;
console.log(p1.name); // name2
console.log(p1.__proto__.name); // name2
console.log(p1.__proto__.__proto__.name); // name1

delete Person.prototype.name;
console.log(p1.name); // name1
console.log(p1.__proto__.name); // name1
console.log(p1.__proto__.__proto__.name); // name1

delete Object.prototype.name;
console.log(p1.name); // undefined
console.log(p1.__proto__.name); // undefined
console.log(p1.__proto__.__proto__.name); // undefined
```

- 查找属性时，优先查实例自身
- 找不到，就沿着 `__proto__` 向上查（即原型链）

------

### 五、补充说明

1. 函数对象有prototype属性，js中对象有`__proto__`属性；

   - js中对象：包括上述实例对象person、以及原型对象Person.prototype和Object.prototype；

2. `__proto__`是非标准属性，现代写法建议用`Object.getPrototypeOf(obj)`代替，下面是将proto替换为getPrototypeOf()两个示例：

   ```js
   // 示例1
   console.log(Person.prototype.__proto__.name);
   console.log(Object.getPrototypeOf(Person.prototype).name);
   
   // 示例二
   console.log(p1.__proto__.name);
   console.log(Person.getPrototypeOf(p1).name);
   ```

   

## 参考
- https://www.yuque.com/cuggz/interview/vgbphi#31e2756dc0fffdd60bbafbcf21cebbc8
- https://www.yuque.com/xiumubai/doc/tths3rcxtohe6ory


